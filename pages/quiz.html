<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz</title>
    <link rel="stylesheet" href="../assets/css/styles.css">
</head>
<body>
    <div class="quiz-container">
        <!-- Header Quiz -->
        <h1 class="quiz-title">Quiz</h1>
        <p class="quiz-progress">Pertanyaan <span id="currentQuestionNumber">1</span> dari <span id="totalQuestions">5</span></p>

        <!-- Pertanyaan -->
        <div id="quizContent" class="quiz-content">
            <!-- Pertanyaan akan ditampilkan di sini -->
        </div>

        <!-- Feedback Jawaban -->
        <div id="feedbackMessage" class="feedback-message"></div>

        <!-- Tombol Navigasi -->
        <div class="quiz-actions">
            <button id="nextQuestionButton" class="auth-button next-question-button">Lanjut</button>
        </div>
    </div>

    <script src="../assets/js/quiz-parser.js"></script>
    <script>
        // Ambil data pertanyaan dari localStorage
        const quizQuestions = JSON.parse(localStorage.getItem('quizQuestions'));
        if (!quizQuestions) {
            alert("Tidak ada pertanyaan tersedia!");
            window.location.href = "pre-lobby.html";
        }

        let currentQuestionIndex = 0;
        let score = 0;

        // Fungsi untuk menampilkan pertanyaan
        function displayQuestion(index) {
            const questionData = quizQuestions[index];
            const { question, option_a, option_b, option_c, option_d } = questionData;

            document.getElementById('quizContent').innerHTML = `
                <p class="quiz-question">${question}</p>
                <label><input type="radio" name="answer" value="A"> ${option_a}</label><br>
                <label><input type="radio" name="answer" value="B"> ${option_b}</label><br>
                <label><input type="radio" name="answer" value="C"> ${option_c}</label><br>
                <label><input type="radio" name="answer" value="D"> ${option_d}</label><br>
            `;

            // Update progress
            document.getElementById('currentQuestionNumber').textContent = index + 1;
            document.getElementById('totalQuestions').textContent = quizQuestions.length;

            // Reset feedback message
            document.getElementById('feedbackMessage').textContent = '';
        }

        // Tampilkan pertanyaan pertama saat halaman dimuat
        displayQuestion(currentQuestionIndex);

        // Handle tombol lanjut
        document.getElementById('nextQuestionButton').addEventListener('click', () => {
            const selectedAnswer = document.querySelector('input[name="answer"]:checked');
            if (!selectedAnswer) {
                document.getElementById('feedbackMessage').textContent = 'Silakan pilih jawaban terlebih dahulu!';
                return;
            }

            // Cek jawaban
            const correctAnswer = quizQuestions[currentQuestionIndex].correct_answer;
            if (selectedAnswer.value === correctAnswer) {
                score++;
                document.getElementById('feedbackMessage').textContent = 'Jawaban kamu benar! ✅';
            } else {
                document.getElementById('feedbackMessage').textContent = 'Jawaban kamu salah! ❌ Jawaban yang benar adalah: ' + correctAnswer;
            }

            // Pindah ke pertanyaan berikutnya
            currentQuestionIndex++;
            if (currentQuestionIndex < quizQuestions.length) {
                setTimeout(() => {
                    displayQuestion(currentQuestionIndex);
                }, 1000); // Delay 1 detik sebelum menampilkan pertanyaan berikutnya
            } else {
                // Simpan skor ke localStorage
                localStorage.setItem('quizScore', score);
                window.location.href = "rekap.html"; // Redirect ke halaman rekap
            }
        });
    </script>
</body>
</html>